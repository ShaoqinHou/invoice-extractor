#!/bin/bash
# SubagentStart hook — injects rules into subagent context

cat <<'EOF'
{"additionalContext": "## Injected Rules for Subagents\n\n### Import Boundaries\n- features/{a}/ CANNOT import from features/{b}/ — use shared components instead\n- components/ui/ CANNOT import from features/\n- Shared components live in: components/ui/ (primitives), components/layout/ (page shell), components/patterns/ (reusable app patterns)\n\n### Available Shared Components\n- Button, Badge, Card (CardHeader, CardContent, CardFooter), Dialog, Input — from @web/components/ui\n- RootLayout, TopBar, PageContainer — from @web/components/layout\n\n### Testing Depth (CRITICAL)\n- Every change needs testing at the APPROPRIATE DEPTH — see .claude/rules/testing.md\n- L1 (Unit): business logic → unit tests with concrete values\n- L2 (Integration): UI↔backend wiring → test clicks trigger correct API calls\n- L3 (Behavioral): user flows → verify interactions produce results in browser\n- L4 (Output): features producing artifacts → verify content correctness\n- 'Visible in snapshot' ≠ 'working'. A button appearing but doing nothing on click = FAIL.\n- Run only YOUR feature tests: npm run test --workspace=packages/web -- src/features/{feature}/\n- Do NOT run the full test suite — that's the lead's job\n- Write tests in: packages/{pkg}/src/{module}/__tests__/{Name}.test.ts\n\n### Ports\n- API: http://localhost:3002\n- Web: http://localhost:5175\n\n### Tech Conventions\n- TypeScript strict, no `any`, named exports, ESM only\n- Shell: Windows MINGW64, use `python` not `python3`\n- Use `node -e` for JSON parsing (jq may not be available)"}
EOF
